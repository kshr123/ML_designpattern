################################################################################
# TDD Green Phase - evaluator.py テスト結果（成功フェーズ）
################################################################################
#
# 目的: モデル評価機能の実装を完了し、全てのテストが通ることを確認する
# 状態: ✅ PASSED - 全テスト成功
# 実行日時: evaluator.py実装後
# コマンド: pytest tests/test_evaluator.py -v --cov=src/iris_sklearn_svc/evaluator.py
#
################################################################################

============================= test session starts ==============================
platform darwin -- Python 3.13.9, pytest-8.4.2, pluggy-1.6.0
cachedir: .pytest_cache
rootdir: /Users/kotaro/Desktop/dev/ML_designpattern/my_implementations/chapter2_training/iris_sklearn_svc
configfile: pyproject.toml
plugins: anyio-4.11.0, cov-7.0.0

collecting ... collected 10 items

tests/test_evaluator.py::TestEvaluateModel::test_evaluate_model_returns_dict PASSED [ 10%]
tests/test_evaluator.py::TestEvaluateModel::test_metrics_contains_required_keys PASSED [ 20%]
tests/test_evaluator.py::TestEvaluateModel::test_accuracy_is_float PASSED [ 30%]
tests/test_evaluator.py::TestEvaluateModel::test_precision_is_float PASSED [ 40%]
tests/test_evaluator.py::TestEvaluateModel::test_recall_is_float PASSED  [ 50%]
tests/test_evaluator.py::TestEvaluateModel::test_metrics_are_in_valid_range PASSED [ 60%]
tests/test_evaluator.py::TestEvaluateModel::test_model_achieves_good_accuracy PASSED [ 70%]
tests/test_evaluator.py::TestEvaluateModel::test_precision_and_recall_are_reasonable PASSED [ 80%]
tests/test_evaluator.py::TestEvaluateModel::test_reproducibility PASSED  [ 90%]
tests/test_evaluator.py::TestEvaluateModel::test_metrics_consistency PASSED [100%]

================================ tests coverage ================================
_______________ coverage: platform darwin, python 3.13.9-final-0 _______________

Name                                  Stmts   Miss  Cover   Missing
-------------------------------------------------------------------
src/iris_sklearn_svc/__init__.py          0      0   100%
src/iris_sklearn_svc/data_loader.py      14      0   100%
src/iris_sklearn_svc/evaluator.py        11      0   100%
src/iris_sklearn_svc/model.py             6      0   100%
src/iris_sklearn_svc/trainer.py           5      0   100%
-------------------------------------------------------------------
TOTAL                                    36      0   100%

============================== 10 passed in 2.43s ===============================

################################################################################
# Green Phase 分析
################################################################################
#
# テスト結果サマリー:
#   ✅ 全10テストケースが成功（PASSED）
#   ✅ コードカバレッジ: 100%（evaluator.py の11ステートメント全て実行）
#   ✅ 実行時間: 2.43秒
#
# 成功したテストケース:
#   1. test_evaluate_model_returns_dict          - 評価結果が辞書で返される ✓
#   2. test_metrics_contains_required_keys       - accuracy, precision, recallが含まれる ✓
#   3. test_accuracy_is_float                    - accuracyがfloat型 ✓
#   4. test_precision_is_float                   - precisionがfloat型 ✓
#   5. test_recall_is_float                      - recallがfloat型 ✓
#   6. test_metrics_are_in_valid_range           - 指標が0-1の範囲内 ✓
#   7. test_model_achieves_good_accuracy         - 精度90%以上達成 ✓
#   8. test_precision_and_recall_are_reasonable  - precision/recall 85%以上 ✓
#   9. test_reproducibility                      - 同じ入力で再現性あり ✓
#   10. test_metrics_consistency                 - F1スコア計算で一貫性確認 ✓
#
# カバレッジ詳細:
#   - src/iris_sklearn_svc/evaluator.py: 11文（100%カバー）
#     - evaluate_model() 関数の全ロジックが実行された
#     - predict, accuracy_score, precision_score, recall_score が正しく動作
#
# 実装内容:
#   - scikit-learnの標準評価指標関数を使用
#   - accuracy_score: 正解率
#   - precision_score: 適合率（マクロ平均）
#   - recall_score: 再現率（マクロ平均）
#   - マクロ平均: 各クラスの指標を平均（クラス間のバランスを考慮）
#
# 全体の累積カバレッジ:
#   - data_loader.py: 14文（100%）
#   - model.py: 6文（100%）
#   - trainer.py: 5文（100%）
#   - evaluator.py: 11文（100%）
#   - 合計: 36文（100%）
#
# TDDサイクル完了:
#   Red（失敗）→ Green（成功）✓
#   次のステップ: exporter.py の実装へ（ONNX変換）
#
################################################################################
